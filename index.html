<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¬Ù‡Ø§Ø² ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø²ÙÙŠØ± - Wigast</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background-color: #f4f6f8;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .container {
      margin-top: 30px;
    }
    img {
      width: 120px;
      margin-bottom: 20px;
    }
    h2 {
      color: #333;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      background-color: #007BFF;
      border: none;
      color: white;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    input {
      width: 80%;
      padding: 10px;
      margin: 10px auto;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      display: block;
    }
    #doctorForm, #patientForm {
      display: none;
      margin-top: 20px;
    }
    #result {
      margin-top: 30px;
      font-size: 18px;
      color: #444;
    }
  </style>
</head>
<body>

<div class="container">
  <img src="https://cdn-icons-png.flaticon.com/512/3798/3798087.png" alt="Ø¬Ù‡Ø§Ø² Wigast">
  <h2>Ø¬Ù‡Ø§Ø² ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØºØ§Ø²Ø§Øª - Wigast</h2>

  <button onclick="askPassword()">Ø·Ø¨ÙŠØ¨</button>
  <button onclick="showForm('patient')">Ù…Ø±ÙŠØ¶</button>

  <div id="doctorForm">
    <h3>Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„</h3>
    <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶">
    <input type="number" id="ch4" placeholder="Ù†Ø³Ø¨Ø© CH4 (Ø§Ù„Ù…ÙŠØ«Ø§Ù†)">
    <input type="number" id="h2" placeholder="Ù†Ø³Ø¨Ø© H2 (Ø§Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ†)">
    <input type="number" id="co2" placeholder="Ù†Ø³Ø¨Ø© CO2 (Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†)">
    <input type="text" id="condition" placeholder="Ø§Ù„Ø­Ø§Ù„Ø©" readonly>
    <button onclick="calculateAndAdd()">Ø¥Ø¶Ø§ÙØ©</button>
  </div>

  <div id="patientForm">
    <h3>Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
    <input type="text" id="patientSearchName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ">
    <button onclick="getData()">Ø¹Ø±Ø¶</button>
  </div>

  <div id="result"></div>
</div>

<script>
  // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyD...", // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
    authDomain: "wigast-26ba7.firebaseapp.com",
    databaseURL: "https://wigast-26ba7-default-rtdb.firebaseio.com",
    projectId: "wigast-26ba7",
    storageBucket: "wigast-26ba7.appspot.com",
    messagingSenderId: "xxxxxxx",
    appId: "1:xxxxxxx:web:xxxxxxx"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
  function askPassword() {
    const password = prompt("ğŸ“Œ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨:");
    if (password === "gastrologue22h") {
      showForm("doctor");
    } else {
      alert("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!");
    }
  }

  function showForm(role) {
    document.getElementById("doctorForm").style.display = (role === "doctor") ? "block" : "none";
    document.getElementById("patientForm").style.display = (role === "patient") ? "block" : "none";
    document.getElementById("result").innerHTML = "";
  }

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©
  function calculateCondition(ch4, h2, co2) {
    let conditions = [];
    if (h2 > 21) conditions.push("â— SIBO: ÙØ±Ø· Ù†Ù…Ùˆ Ø§Ù„Ø¨ÙƒØªÙŠØ±ÙŠØ§ ÙÙŠ Ø§Ù„Ø£Ù…Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© (Ø§Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ† Ù…Ø±ØªÙØ¹)");
    if (ch4 > 10) conditions.push("â— IBS: Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ù„Ù‚ÙˆÙ„ÙˆÙ† Ø§Ù„Ø¹ØµØ¨ÙŠ (Ø§Ù„Ù…ÙŠØ«Ø§Ù† Ù…Ø±ØªÙØ¹)");
    if (co2 < 10) conditions.push("âš ï¸ ABS: Ø®Ù„Ù„ Ø§Ù…ØªØµØ§Øµ Ø£Ùˆ Ù†Ø´Ø§Ø· ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ Ù„Ù„Ø¨ÙƒØªÙŠØ±ÙŠØ§ Ø§Ù„Ù„Ø§Ù‡ÙˆØ§Ø¦ÙŠØ©");
    return conditions.length ? conditions.join(" | ") : "âœ… Ø­Ø§Ù„Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©";
  }

  // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶
  function calculateAndAdd() {
    const name = document.getElementById("name").value.trim();
    const ch4 = parseFloat(document.getElementById("ch4").value);
    const h2 = parseFloat(document.getElementById("h2").value);
    const co2 = parseFloat(document.getElementById("co2").value);

    if (name && !isNaN(ch4) && !isNaN(h2) && !isNaN(co2)) {
      const condition = calculateCondition(ch4, h2, co2);
      document.getElementById("condition").value = condition;

      db.ref("patients/" + name).set({ ch4, h2, co2, condition }).then(() => {
        alert("âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        document.getElementById("name").value = "";
        document.getElementById("ch4").value = "";
        document.getElementById("h2").value = "";
        document.getElementById("co2").value = "";
        document.getElementById("condition").value = "";
      });
    } else {
      alert("â— ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø§Ù†Ø§Øª Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­Ø©");
    }
  }

  // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø±ÙŠØ¶
  function getData() {
    const name = document.getElementById("patientSearchName").value.trim();
    if (name) {
      db.ref("patients/" + name).once("value").then(snapshot => {
        if (snapshot.exists()) {
          const data = snapshot.val();
          document.getElementById("result").innerHTML = `
            <h4>ğŸ“‹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</h4>
            <p>CH4: ${data.ch4}</p>
            <p>H2: ${data.h2}</p>
            <p>CO2: ${data.co2}</p>
            <p>Ø§Ù„Ø­Ø§Ù„Ø©: ${data.condition}</p>
          `;
        } else {
          document.getElementById("result").innerHTML = "<p>âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…</p>";
        }
      });
    } else {
      alert("â— ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù…");
    }
  }
</script>

</body>
</html>
